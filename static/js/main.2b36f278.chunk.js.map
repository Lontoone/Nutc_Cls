{"version":3,"sources":["Components/InlineCheckBox.js","utils/sql-wasm.wasm","Components/DbHelper.js","Components/ClassTabel.js","pages/Home.js","pages/SqlApi.js","App.js","reportWebVitals.js","index.js"],"names":["InlineCheckBox","props","state","console","log","className","this","opts","map","a","i","value","onClick","e","setState","_this","target","classList","contains","remove","isChecked","add","handelItemClicked","text","Component","relLink","process","loadBinaryFile","path","success","xhr","XMLHttpRequest","open","responseType","onload","data","Uint8Array","response","arr","Array","length","String","fromCharCode","join","send","sql","callback","initSqlJs","locateFile","sqlWasm","SQL","res","Database","exec","GetDb","ClassTabel","useState","setData","useMemo","OnDataGet","colNameMap","col","_name","semi","clsno","clsfor","clsName","clsRoom","sch_typeNameMap","table","columns","values","Home","semiOptions","setSemiOptions","doSql","setSql","useEffect","flat","weekRef","useRef","schTypeRef","semiRef","startRef","endRef","fixedDurationRef","href","src","options","placeholder","ref","type","min","max","defaultValue","current","selected","weeks","sch_type","start","end","isFixedDuration","checked","selectedWeeks","reduce","acc","val","concat","selectedSchTypes","week_sql","schType_sql","start_sql_eq","end_sql_eq","HandleSearch","class","window","SqlApi","cls_id","Date","getFullYear","query","location","toString","replace","paras","URLSearchParams","get","split","selectedst","queryItems","push","App","element","exact","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","createRoot","document","getElementById","render","StrictMode"],"mappings":"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","file":"static/js/main.2b36f278.chunk.js","sourcesContent":["import PropTypes from \"prop-types\";\r\nimport React, { Component } from \"react\";\r\nimport \"../css/InlineCheckBox.css\";\r\n//TODO: 可以做成插件公布\r\nexport default class InlineCheckBox extends Component {\r\n  state = {};\r\n  constructor(props) {\r\n    super(props);\r\n    //this.state = props;\r\n    this.state = { ...props };\r\n    //this.handelItemClicked = this.\r\n    console.log(this.state);\r\n  }\r\n\r\n  render() {\r\n    function handelItemClicked(_this, e, i) {\r\n      //取消選取\r\n      if (e.target.classList.contains(\"ilcb-selected\")) {\r\n        e.target.classList.remove(\"ilcb-selected\");\r\n        _this.state.opts[i].isChecked = false;\r\n      } \r\n      //選取\r\n      else {\r\n        _this.state.opts[i].isChecked = true;\r\n        e.target.classList.add(\"ilcb-selected\");\r\n      }\r\n\r\n      return _this.state.opts;\r\n    }\r\n    return (\r\n      <div className=\"ilcb-root\" key={\"ilcb-root\"}>\r\n        {this.state.opts.map((a, i) => {\r\n          return (\r\n            <div\r\n              className=\"ilcb-item\"\r\n              key={\"ilcb-item\" + i}\r\n              value={a.value}\r\n              onClick={(e) => {\r\n                this.setState(handelItemClicked(this, e, i));\r\n              }}\r\n            >\r\n              {a.text}\r\n            </div>\r\n          );\r\n\r\n          console.log(a);\r\n        })}\r\n       \r\n      </div>\r\n    );\r\n  }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/sql-wasm.057823fe.wasm\";","import initSqlJs from \"sql.js\";\r\n//import sqlWasm from \"!!file-loader?name=sql-wasm-[contenthash].wasm!sql.js/dist/sql-wasm.wasm\";\r\nimport sqlWasm from \"../utils/sql-wasm.wasm\";\r\nimport fs from \"fs\";\r\nimport React, { useMemo } from 'react';\r\n\r\nconst relLink = process.env.PUBLIC_URL + \"/Datas/cls.db\";\r\n\r\n\r\nasync function loadBinaryFile(path, success) {\r\n  var xhr = new XMLHttpRequest();\r\n  xhr.open(\"GET\", path, true);\r\n  xhr.responseType = \"arraybuffer\";\r\n  xhr.onload = function () {\r\n    var data = new Uint8Array(xhr.response);\r\n    var arr = new Array();\r\n    for (var i = 0; i != data.length; ++i) arr[i] = String.fromCharCode(data[i]);\r\n    success(arr.join(\"\"));\r\n  };\r\n  xhr.send();\r\n};\r\nasync function GetDb(sql,callback) {\r\n  const SQL = await initSqlJs({ locateFile: () => sqlWasm });\r\n  //const db = new SQL.Database(\"url/cls.db\");\r\n\r\n  await loadBinaryFile(relLink, function (data) {\r\n    var sqldb = new SQL.Database(data);\r\n    // Database is ready\r\n    //var res = sqldb.exec(\"SELECT * FROM cls\");\r\n    var res = sqldb.exec(sql);    \r\n\r\n    callback(res);\r\n  });\r\n}\r\n\r\nexport default GetDb;\r\n\r\n","import React, { useMemo, useState } from \"react\";\r\nimport \"../css/reset.css\";\r\nimport \"../css/ClassTable.css\";\r\nimport GetDb from \"../Components/DbHelper\";\r\n\r\n//var searchData = [];\r\nexport default function ClassTabel({ sql }) {\r\n  //const [sql, setSql] = useState(\"SELECT * FROM cls LIMIT 10\");\r\n  const [data, setData] = useState([]);\r\n  const searchResult = useMemo(() => GetDb(sql, OnDataGet), [sql]);\r\n  function OnDataGet(data) {\r\n    //searchData = data;\r\n    console.log(data);\r\n    setData(data);\r\n  }\r\n\r\n  const colNameMap = (col) => {\r\n    const colMap = {\r\n      semi: \"學年\",\r\n      clsno: \"編號\",\r\n      clsfor: \"班級\",\r\n      clsName: \"課程名稱\",\r\n      clsRoom: \"教室\",\r\n      semi: \"學年\",\r\n      clsOpt: \"選/必修\",\r\n      week: \"星期\",\r\n      hour: \"時數\",\r\n      crid: \"學分\",\r\n      stuCount: \"人數\",\r\n      teacher: \"老師\",\r\n      sch_type: \"學制\",\r\n      start: \"開始節\",\r\n      end: \"結束節\",\r\n    };\r\n    let _name = colMap[col];\r\n    if (_name) {\r\n      return _name;\r\n    } else {\r\n      //找不到對應的就返回英文\r\n      return col;\r\n    }\r\n  };\r\n  const sch_typeNameMap = (col) => {\r\n    const colMap = {\r\n      1: \"五專\",\r\n      3: \"二技\",\r\n      4: \"四技\",\r\n      8: \"碩班\",\r\n    };\r\n    let _name = colMap[col];\r\n    if (_name) {\r\n      return _name;\r\n    } else {\r\n      //找不到對應的就返回英文\r\n      return col;\r\n    }\r\n  };\r\n\r\n  const table = useMemo(() => {\r\n    return (\r\n      <table key={\"tc\"}>\r\n        <thead>\r\n          <tr>\r\n            {data[0]?.columns.map((a, i) => {\r\n              return (\r\n                <th key={a + i} className=\"tc-header-tr\">\r\n                  {colNameMap(a)}\r\n                </th>\r\n              );\r\n            })}\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {data[0]?.values.map((a, i) => {\r\n            return (\r\n              <tr key={a + i}>\r\n                {a.map((col, i) => {\r\n                  //偷懶 sch_type剛好是最後一欄，轉對應名稱\r\n                  return (\r\n                    <td className=\"tc-body-td\">                      \r\n                      {i == (a.length - 1) ? sch_typeNameMap(col) : col}\r\n                    </td>\r\n                  );\r\n                })}\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    );\r\n  }, [data]);\r\n\r\n  return <div className=\"tc-root\">{table}</div>;\r\n}\r\n","import React, { Component, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport \"../css/reset.css\";\r\nimport \"../css/mainStyle.css\";\r\nimport \"../css/DialogBox.css\";\r\nimport Dropdown from \"react-dropdown\"; //https://github.com/fraserxu/react-dropdown\r\nimport \"react-dropdown/style.css\";\r\nimport InlineCheckBox from \"../Components/InlineCheckBox\";\r\n//import sqlite3 from 'sqlite3';\r\nimport GetDb from \"../Components/DbHelper\";\r\nimport ClassTabel from \"../Components/ClassTabel\";\r\n\r\n//const initSqlJs = window.initSqlJs;\r\n\r\n//TODO: SQLite: https://github.com/sql-js/sql.js\r\n\r\nexport default function Home() {\r\n  /*\r\n  const searchResult = useMemo(() => (\r\n    GetDb(sql)\r\n    ), [sql])\r\n    */\r\n  const [semiOptions, setSemiOptions] = useState([]);\r\n  //const [doSql, setSql] = useState(\"SELECT * FROM cls LIMIT 10\");\r\n  const [doSql, setSql] = useState(\"\");\r\n\r\n  const weekOpts = [\r\n    { text: \"一\", value: \"星期一\" },\r\n    { text: \"二\", value: \"星期二\" },\r\n    { text: \"三\", value: \"星期三\" },\r\n    { text: \"四\", value: \"星期四\" },\r\n    { text: \"五\", value: \"星期五\" },\r\n    { text: \"六\", value: \"星期六\" },\r\n    { text: \"日\", value: \"星期日\" },\r\n  ];\r\n\r\n  const sch_typeOpts = [\r\n    { text: \"五專\", value: \"1\" },\r\n    { text: \"二技\", value: \"3\" },\r\n    { text: \"四技\", value: \"4\" },\r\n    { text: \"碩班\", value: \"8\" },\r\n  ];\r\n  useEffect(() => {\r\n    //取得資料庫裡面有的學年\r\n    var sql = \"SELECT DISTINCT semi FROM cls\";\r\n    GetDb(sql, (res) => {\r\n      console.log(res[0]?.values.flat());\r\n      setSemiOptions(res[0]?.values.flat());\r\n    });\r\n  }, []);\r\n\r\n  const weekRef = useRef(\"weekRef\");\r\n  const schTypeRef = useRef(\"schTypeRef\");\r\n  const semiRef = useRef(\"semiRef\");\r\n  const startRef = useRef(\"startRef\");\r\n  const endRef = useRef(\"endRef\");\r\n  const fixedDurationRef = useRef(\"fixedDurationRef\");\r\n  //console.log(searchResult);\r\n\r\n  function HandleSearch() {\r\n    console.log(\"Search\");\r\n    var semi = semiRef.current.state.selected.value;\r\n    var weeks = weekRef.current.state.opts;\r\n    var sch_type = schTypeRef.current.state.opts;\r\n    var start = startRef.current.value;\r\n    var end = endRef.current.value;\r\n    var isFixedDuration =fixedDurationRef.current.checked;    \r\n\r\n    var selectedWeeks = weeks.reduce(\r\n      (acc, val) => (val.isChecked ? acc.concat(\"'\" + val.value + \"'\") : acc),\r\n      []\r\n    );\r\n    var selectedSchTypes = sch_type.reduce(\r\n      (acc, val) => (val.isChecked ? acc.concat(\"'\" + val.value + \"'\") : acc),\r\n      []\r\n    );\r\n    var week_sql = selectedWeeks.join(\",\");\r\n    var schType_sql = selectedSchTypes.join(\",\");\r\n    var start_sql_eq = isFixedDuration? \"==\" :\">=\";\r\n    var end_sql_eq = isFixedDuration? \"==\" :\"<=\";\r\n    console.log(semi);\r\n    console.log(weeks);\r\n    console.log(start);\r\n    console.log(end);\r\n    console.log(selectedWeeks);\r\n    console.log(week_sql);\r\n\r\n    var sql = `SELECT * from cls WHERE \r\n                        semi='${semi}' AND \r\n                        start ${start_sql_eq} ${start} AND\r\n                        end ${end_sql_eq} ${end} AND\r\n                        week IN (${week_sql}) AND\r\n                        sch_type IN (${schType_sql})\r\n\r\n                        `;\r\n    console.log(sql);\r\n    setSql(sql);\r\n  }\r\n\r\n  return (\r\n    <div className=\"full-screen\">\r\n      {/* 要更新摳我 */}\r\n      <div className=\"call-me-btn-root\">\r\n        <div className=\"dialog\">\r\n          <ul>            \r\n            <li>\r\n              <a href=\"http://lontoone.github.io/me\">要更新Call我，或自己clone下來執行。</a>\r\n            </li>\r\n          </ul>\r\n          <div className=\"arrow\"></div>\r\n        </div>\r\n        <a href=\"http://lontoone.github.io/me\" target={\"_blank\"}>\r\n        <img src=\"https://avatars.githubusercontent.com/u/45337164?s=400&u=189572e08cf2a7d3547556b33eabf28e5f3596ed&v=4\"></img>\r\n        </a>\r\n      </div>\r\n\r\n      <div className=\"home-title\">中科大全校課表査詢</div>\r\n      {/* 主內容 */}\r\n      <div className=\"shadow home-center-container\">\r\n        {/* 選單項目 --學年 */}\r\n        <div className=\"form-item\">\r\n          <p>學年</p>\r\n          <Dropdown\r\n            className=\"home-dropDown\"\r\n            options={semiOptions}\r\n            //onChange={this._onSelect}\r\n            /*value={semiOptions[0]}*/\r\n            placeholder=\"選擇學年\"\r\n            ref={semiRef}\r\n          />\r\n        </div>\r\n\r\n        {/* 選單項目 --星期 */}\r\n        <div className=\"form-item\">\r\n          <p>星期</p>\r\n          <InlineCheckBox opts={weekOpts} ref={weekRef} />\r\n        </div>\r\n\r\n        {/* 選單項目 --起始節 */}\r\n        <div className=\"form-item\">\r\n          <p>節數</p>\r\n          <input\r\n            className=\"form-item-input\"\r\n            type={\"number\"}\r\n            min={1}\r\n            max={8}\r\n            defaultValue={1}\r\n            ref={startRef}\r\n          ></input>\r\n          <p>~</p>\r\n          <input\r\n            className=\"form-item-input\"\r\n            type={\"number\"}\r\n            min={1}\r\n            max={8}\r\n            defaultValue={8}\r\n            ref={endRef}\r\n          ></input>\r\n\r\n          <input type={\"checkbox\"} ref={fixedDurationRef}></input>\r\n          完全符合\r\n        </div>\r\n\r\n        {/* 選單項目 --學制 */}\r\n        <div className=\"form-item\">\r\n          <p>學制</p>\r\n          <InlineCheckBox opts={sch_typeOpts} ref={schTypeRef} />\r\n        </div>\r\n\r\n        {/* 選單項目 --搜尋按鈕 */}\r\n        <div className=\"form-item-full-button\" onClick={() => HandleSearch()}>\r\n          搜尋\r\n        </div>\r\n      </div>\r\n\r\n      {/* 個人連結 */}\r\n      <div className=\"home-socialbtn-group\">\r\n        {/* 巴哈 \r\n        <button\r\n          class=\"\"\r\n          onClick={() => {\r\n            const url =\r\n              \"https://home.gamer.com.tw/homeindex.php?owner=news2000tw\";\r\n            window.open(url, \"_blank\");\r\n          }}\r\n        >\r\n          <img\r\n            className=\"smallIcon\"\r\n            src=\"https://cdn6.aptoide.com/imgs/e/f/a/efae200e586d616b816b01affb3e63d1_icon.png\"\r\n          ></img>\r\n        </button>*/}\r\n\r\n        {/* Github */}\r\n        <button\r\n          class=\"\"\r\n          onClick={() => {\r\n            const url = \"https://github.com/Lontoone/Nutc_Cls\";\r\n            window.open(url, \"_blank\");\r\n          }}\r\n        >\r\n          <img\r\n            className=\"smallIcon\"\r\n            src=\"https://i.imgur.com/cpN5Xlp.png\"\r\n          ></img>\r\n        </button>\r\n\r\n        {/* IG \r\n        <button\r\n          class=\"\"\r\n          onClick={() => {\r\n            const url = \"https://www.instagram.com/lontoone/\";\r\n            window.open(url, \"_blank\");\r\n          }}\r\n        >\r\n          <img\r\n            className=\"smallIcon\"\r\n            src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Instagram_icon.png/2048px-Instagram_icon.png\"\r\n          ></img>\r\n        </button>*/}\r\n      </div>\r\n\r\n      {/* 搜尋結果 */}\r\n      <div className=\"home-main-seg\">\r\n        <ClassTabel sql={doSql} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useMemo, useState, Component } from \"react\";\r\nimport ClassTabel from \"../Components/ClassTabel\";\r\nimport GetDb from \"../Components/DbHelper\";\r\n/*\r\nclass Api extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { data: \"\" };\r\n    this.handleLoad = this.handleLoad.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    window.addEventListener(\"load\", this.handleLoad);\r\n    console.log(\"window Load\");\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener(\"load\", this.handleLoad);\r\n  }\r\n\r\n  handleLoad() {\r\n    console.log(\"handleLoad\");\r\n    var data = SqlApi();\r\n    const webData = GetDb(data, (a) => {\r\n      this.setState({ data: a });\r\n    });\r\n    console.log(webData);\r\n\r\n  }\r\n\r\n  render() {\r\n    console.log(this.state.data);\r\n    var data = [];\r\n    this.state.data[0]?.values.map((a, i) => {\r\n      a?.map((row) => {\r\n        data.push(row);\r\n      });\r\n    });\r\n\r\n    document.title=data.join(\"|\");\r\n\r\n    return (\r\n      <>\r\n        {this.state.data[0]?.values.map((a, i) => {\r\n          return (\r\n            <tr>\r\n              {a?.map((row) => {\r\n                data.push(row);\r\n                return <td>{row},</td>;\r\n              })}\r\n            </tr>\r\n          );\r\n        })}\r\n      </>\r\n    );\r\n    // return <>{this.state.data[0]?.columns[0]}</>;\r\n  }\r\n}\r\n*/\r\nfunction SqlApi() {\r\n  //取得URL參數 (注意格式，?要接先一個&，例如下方)\r\n  //不然React在搞，取不到第一個參數\r\n  //http://localhost:3000/#/api/?&semi=1101&weeks=星期一,星期二,星期三&end=8&start=1&sch_type=1\r\n  //http://localhost:3000/#/api/?&cid=D2441\r\n  //http://localhost:3000/#/api/?&cid=D2441&semi=1091\r\n  var cls_id = \"\";\r\n  var semi = new Date().getFullYear - 1911 + \"1\";\r\n  var weeks = \"1,2,3,4,5,6,7\";\r\n  var end = 8;\r\n  var start = 1;\r\n  var sch_type = 1;\r\n\r\n  var currUrl = window.location.toString();\r\n\r\n  const query = currUrl.replace(\"#/\", \"\");\r\n  const paras = new URLSearchParams(query);\r\n  console.log(query);\r\n  console.log(paras);\r\n  cls_id = paras.get(\"cid\");\r\n  semi = paras.get(\"semi\");\r\n  weeks = paras.get(\"weeks\");\r\n  end = paras.get(\"end\");\r\n  start = paras.get(\"start\");\r\n  sch_type = paras.get(\"sch_type\");\r\n  var selectedWeeks = weeks\r\n    ? weeks\r\n        .split(\",\")\r\n        .reduce((acc, val) => acc.concat(\"'\" + val + \"'\"), [])\r\n        .join(\",\")\r\n    : null;\r\n\r\n  var selectedst = sch_type\r\n    ? sch_type\r\n        .split(\",\")\r\n        .reduce((acc, val) => acc.concat(\"'\" + val + \"'\"), [])\r\n        .join(\",\")\r\n    : null;\r\n  /*\r\n    var sql = `SELECT * from cls WHERE \r\n                          semi = '${semi}' AND\r\n                          start >=${start} AND\r\n                          end <=${end} AND\r\n                          week IN (${selectedWeeks}) AND\r\n                          sch_type IN (${selectedst})\r\n                          `;\r\n  */\r\n  var queryItems = [];\r\n  if (cls_id != null) queryItems.push(\"clsno='\" + cls_id + \"'\");\r\n  if (semi != null) queryItems.push(\"semi='\" + semi + \"'\");\r\n  if (start != null) queryItems.push(\"start>=\" + start);\r\n  if (end != null) queryItems.push(\"end<=\" + end);\r\n  if (weeks != null) queryItems.push(\"week IN(\" + selectedWeeks + \")\");\r\n  if (sch_type != null) queryItems.push(\"sch_type IN(\" + selectedst + \")\");\r\n\r\n  var sql = `SELECT * from cls WHERE  ${queryItems.join(\" AND \")}`;\r\n  /*\r\n    var sql = `SELECT * from cls WHERE \r\n                          ${cls_id != null ? \"clsno='\" + cls_id + \"' AND\" : \"\"}  \r\n                          ${semi != null ? \"semi='\" + semi + \"' AND\" : \"\"}  \r\n                          ${start != null ? \"start>=\" + start + \" AND\" : \"\"}\r\n                          ${end != null ? \"end<=\" + end + \" AND\" : \"\"}\r\n                          ${weeks != null ? \"week IN(\" + selectedWeeks + \") AND\" : \"\"}\r\n                          ${sch_type != null ? \"sch_type IN(\" + selectedst +\")\" : \"\"}\r\n                          `;\r\n                          */\r\n  console.log(sql);\r\n  //return sql;\r\n\r\n  \r\n  const res = useMemo(() => {\r\n    return <ClassTabel sql={sql} />;\r\n  });\r\n\r\n  return <>{res}</>;\r\n  \r\n  //return urlToSql();\r\n}\r\n\r\n//export default SqlApi;\r\nexport default SqlApi;\r\n","//import logo from './logo.svg';\r\nimport \"./App.css\";\r\nimport { Routes, Route } from \"react-router-dom\";\r\nimport Home from \"./pages/Home\";\r\nimport SqlApi from \"./pages/SqlApi\";\r\n\r\nfunction App() {\r\n  return (\r\n    <Routes>       \r\n      <Route path=\"/api\" element={<SqlApi/>}></Route>          \r\n      <Route exact path=\"/\" element={ <Home />}></Route>\r\n      \r\n    </Routes>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\n//import ReactDOM from 'react-dom/client';\r\nimport './index.css';\r\nimport App from './App.js';\r\nimport reportWebVitals from './reportWebVitals';\r\n//import ReactDOM from 'react-dom';\r\nimport ReactDOM from 'react-dom/client';\r\nimport { HashRouter } from 'react-router-dom'\r\n\r\n\r\nconst root = ReactDOM.createRoot(document.getElementById('root'));\r\nroot.render(\r\n  <React.StrictMode>\r\n    {/* HashRouter網址前面要多加#  */}\r\n    <HashRouter>\r\n    <App />\r\n    </HashRouter>\r\n  </React.StrictMode>\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}